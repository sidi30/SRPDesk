{
  "permissions": {
    "allow": [
      "Bash(./mvnw compile:*)",
      "Bash(mvn test:*)",
      "Bash(npm install:*)",
      "Bash(npx tsc:*)",
      "Bash(npm run build:*)",
      "Bash(mvn compile:*)",
      "Bash(mvn spring-boot:run:*)",
      "Bash(npm run dev:*)",
      "Bash(docker compose:*)",
      "Bash(docker compose rm:*)",
      "Bash(docker volume rm:*)",
      "Bash(docker ps:*)",
      "Bash(docker exec:*)",
      "Bash(netstat:*)",
      "Bash(tasklist:*)",
      "Bash(wmic process where \"ProcessId=2468\" get Name,CommandLine)",
      "Bash(powershell -Command \"Get-Process -Id 2468 | Select-Object Name, Path\")",
      "Bash(curl:*)",
      "Bash(python -m json.tool:*)",
      "Bash(echo:*)",
      "Bash(docker restart:*)",
      "Bash(cmd.exe /c \"start \"\"\"\" \"\"C:\\\\Program Files\\\\Docker\\\\Docker\\\\Docker Desktop.exe\"\"\")",
      "Bash(docker info:*)",
      "Bash(docker version:*)",
      "Bash(curl.exe:*)",
      "Bash(1 cat /tmp/tkn.json)",
      "Bash(TKN=\"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICItMF9Jbmg4SXBvVTdWSG9IX05NMnRwOGRzN3NXdWVSX2JucWMxWHNVeUJ3In0.eyJleHAiOjE3NzE1NDQzNjgsImlhdCI6MTc3MTU0NDA2OCwianRpIjoiNTgyZGM0NGYtOGZjOC00NDEzLWI5YzctYzU5MjI1OWU1YzRmIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MTgwL3JlYWxtcy9sZXhzZWN1cmEiLCJzdWIiOiIyNjNjN2Q5Yy05Zjg4LTQ3MGQtOGUwMC0wMWIwMGFkNjNlNTciLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJmcm9udGVuZCIsInNlc3Npb25fc3RhdGUiOiI1MDBkODUzNS04MjZjLTQ1ODYtOWEyMS1kYjJjZGI0Y2EwNjkiLCJzY29wZSI6InByb2ZpbGUgZW1haWwgb3BlbmlkIHJvbGVzIiwic2lkIjoiNTAwZDg1MzUtODI2Yy00NTg2LTlhMjEtZGIyY2RiNGNhMDY5Iiwib3JnX2lkIjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAxIiwicm9sZXMiOlsiQURNSU4iLCJBRE1JTiJdLCJuYW1lIjoiQWRtaW4gVXNlciIsImdpdmVuX25hbWUiOiJBZG1pbiIsImZhbWlseV9uYW1lIjoiVXNlciIsImVtYWlsIjoiYWRtaW5AbGV4c2VjdXJhLmNvbSJ9.VosAyLXp0EtMTDMp6gFnITzDfJb1LXIHP2GWWWzBxtolII2DHfb9ouClOjC2GVpWU9mxLwL7oIVxyz-qwv3ua9e__f_ugygTU-yA7i6V5vfC8H_GGLf67p19azOujQAp_Q1ajZ-Lzk6J87hhXWxfELu8pOe2t7sWlSMED6DBY4d969q19HvJX3hECkTplqMdlJKjUWuYavs2G2_bh91JSQggjmQPHgRdvaeZCYVivv9ClqFJXvbLmmzqJgklAIOT32Azxh5K1CcvnW5Ml6YMrryEmC3hcx8zQ98FaIwARGSFBiM_IOZImLo6FhJd3ji3ZGdzkn4bD_VFhUqx7Yvcew\")",
      "Bash(powershell -Command \"Invoke-WebRequest -Uri ''http://localhost:8080/actuator/health'' -UseBasicParsing | Select-Object -ExpandProperty Content\")",
      "Bash(powershell -Command:*)",
      "Bash(python3:*)",
      "Bash(powershell -ExecutionPolicy Bypass -File \"C:/Users/ramzi/Desktop/devs/lexsecura/infra/test-api.ps1\")",
      "Bash(powershell -ExecutionPolicy Bypass -File \"C:/Users/ramzi/Desktop/devs/lexsecura/infra/test-api2.ps1\")",
      "Bash(powershell -ExecutionPolicy Bypass -Command @'\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n$base = \"\"http://localhost:3000\"\"\n$t = \\(Invoke-RestMethod -Method Post -Uri \"\"http://localhost:8180/realms/lexsecura/protocol/openid-connect/token\"\" -Body @{client_id=\"\"frontend\"\";grant_type=\"\"password\"\";username=\"\"admin@lexsecura.com\"\";password=\"\"admin123\"\";scope=\"\"openid\"\"}\\).access_token\n$h = @{Authorization=\"\"Bearer $t\"\";\"\"Content-Type\"\"=\"\"application/json\"\"}\n$hn = @{Authorization=\"\"Bearer $t\"\"}\n\nWrite-Host \"\"=== Token OK ===\"\" -ForegroundColor Green\n\n# Create product\n$np = Invoke-RestMethod -Method Post -Uri \"\"$base/api/v1/products\"\" -Headers $h -Body '{\"name\":\"E2E Test Product\",\"type\":\"CLASS_II\",\"criticality\":\"MEDIUM\"}'\n$prodId = $np.id\nWrite-Host \"\"CREATE product: OK \\(id=$prodId\\)\"\" -ForegroundColor Green\n\n# Get product\n$gp = Invoke-RestMethod -Uri \"\"$base/api/v1/products/$prodId\"\" -Headers $hn\nWrite-Host \"\"GET product: OK \\($\\($gp.name\\)\\)\"\" -ForegroundColor Green\n\n# Update product\n$up = Invoke-RestMethod -Method Put -Uri \"\"$base/api/v1/products/$prodId\"\" -Headers $h -Body '{\"name\":\"E2E Updated\",\"type\":\"CRITICAL\",\"criticality\":\"HIGH\"}'\nWrite-Host \"\"PUT product: OK \\($\\($up.name\\) -> $\\($up.type\\)\\)\"\" -ForegroundColor Green\n\n# Create release\n$rel = Invoke-RestMethod -Method Post -Uri \"\"$base/api/v1/products/$prodId/releases\"\" -Headers $h -Body '{\"version\":\"2.0.0\",\"gitRef\":\"abc123\"}'\n$relId = $rel.id\nWrite-Host \"\"CREATE release: OK \\(v$\\($rel.version\\), id=$relId\\)\"\" -ForegroundColor Green\n\n# List releases\n$rels = Invoke-RestMethod -Uri \"\"$base/api/v1/products/$prodId/releases\"\" -Headers $hn\nWrite-Host \"\"GET releases: OK \\($\\($rels.Count\\) release\\)\"\" -ForegroundColor Green\n\n# List evidences\n$evs = Invoke-RestMethod -Uri \"\"$base/api/v1/releases/$relId/evidences\"\" -Headers $hn\nWrite-Host \"\"GET evidences: OK \\($\\($evs.Count\\) evidence\\)\"\" -ForegroundColor Green\n\n# List components\n$comps = Invoke-RestMethod -Uri \"\"$base/api/v1/releases/$relId/components\"\" -Headers $hn\nWrite-Host \"\"GET components: OK \\($\\($comps.Count\\) component\\)\"\" -ForegroundColor Green\n\n# List findings for release\n$fds = Invoke-RestMethod -Uri \"\"$base/api/v1/releases/$relId/findings\"\" -Headers $hn\nWrite-Host \"\"GET release findings: OK \\($\\($fds.Count\\) finding\\)\"\" -ForegroundColor Green\n\n# List findings for product\n$pf = Invoke-RestMethod -Uri \"\"$base/api/v1/products/$prodId/findings\"\" -Headers $hn\nWrite-Host \"\"GET product findings: OK \\($\\($pf.Count\\) finding\\)\"\" -ForegroundColor Green\n\n# Audit verify\n$av = Invoke-RestMethod -Uri \"\"$base/api/v1/audit/verify\"\" -Headers $hn\nWrite-Host \"\"AUDIT verify: OK \\(valid=$\\($av.valid\\), events=$\\($av.totalEvents\\)\\)\"\" -ForegroundColor Green\n\n# Audit events\n$ae = Invoke-RestMethod -Uri \"\"$base/api/v1/audit/events\"\" -Headers $hn\nWrite-Host \"\"AUDIT events: OK \\($\\($ae.Count\\) events\\)\"\" -ForegroundColor Green\n\n# Me\n$me = Invoke-RestMethod -Uri \"\"$base/api/v1/me\"\" -Headers $hn\nWrite-Host \"\"GET /me: OK \\(org=$\\($me.currentOrgId\\)\\)\"\" -ForegroundColor Green\n\n# Orgs\n$orgs = Invoke-RestMethod -Uri \"\"$base/api/v1/orgs\"\" -Headers $hn\nWrite-Host \"\"GET /orgs: OK \\($\\($orgs.Count\\) orgs\\)\"\" -ForegroundColor Green\n\n# Delete product \\(cleanup\\)\nInvoke-RestMethod -Method Delete -Uri \"\"$base/api/v1/products/$prodId\"\" -Headers $hn\nWrite-Host \"\"DELETE product: OK\"\" -ForegroundColor Green\n\nWrite-Host \"\"\"\"\nWrite-Host \"\"==============================\"\" -ForegroundColor Yellow\nWrite-Host \"\"  ALL 14 TESTS PASSED\"\" -ForegroundColor Yellow\nWrite-Host \"\"==============================\"\" -ForegroundColor Yellow\n'@)",
      "Bash(npx vite build)",
      "Bash(node -e:*)",
      "WebSearch",
      "WebFetch(domain:cyclonedx.org)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:fossa.com)",
      "WebFetch(domain:www.cybeats.com)",
      "Bash(mvn test-compile:*)",
      "Bash(grep:*)",
      "Bash(ls:*)"
    ]
  }
}
